---
apiVersion: v1
kind: ConfigMap
metadata:
  name: was-config
  namespace: 3tier-app
  labels:
    app: was
    tier: middleware
data:
  # 애플리케이션 설정
  application.properties: |
    # Database Connection
    spring.datasource.url=jdbc:mysql://${DB_HOST}:${DB_PORT}/${DB_NAME}?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Seoul
    spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
    spring.datasource.username=${DB_USER}
    spring.datasource.password=${DB_PASSWORD}

    # JPA 설정
    spring.jpa.hibernate.ddl-auto=update
    spring.jpa.show-sql=false
    spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

    # 서버 설정
    server.port=8080
    server.servlet.context-path=/

    # 로깅 설정
    logging.level.root=INFO
    logging.level.org.springframework.web=INFO

  # JVM 옵션
  JAVA_OPTS: "-Xms512m -Xmx1024m -XX:+UseG1GC -XX:MaxGCPauseMillis=200"

  # Tomcat 설정
  CATALINA_OPTS: "-Dspring.profiles.active=production -Dspring.config.location=file:/opt/app/config/application.properties"
